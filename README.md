# ChatList

Приложение для сравнения ответов различных нейросетей на один и тот же промт.

## Описание

ChatList — это Python-приложение с графическим интерфейсом на PyQt5, которое позволяет:
- Отправлять один промт в несколько нейросетей одновременно
- Сравнивать ответы разных моделей в удобной таблице
- Сохранять интересные результаты в базу данных
- Управлять промтами, моделями и результатами
- Экспортировать результаты в Markdown или JSON

## Поддерживаемые API

- OpenAI (GPT-3.5, GPT-4 и др.)
- DeepSeek
- Groq
- Anthropic (Claude)
- OpenRouter (доступ к множеству моделей через единый API)

## Установка

### Требования

- Python 3.11+
- PyQt5
- SQLite (встроен в Python)

### Установка зависимостей

```powershell
pip install -r requirements.txt
```

### Настройка API-ключей

1. Создайте файл `.env.local` в корне проекта
2. Добавьте ваши API-ключи:

```env
# OpenAI API
OPENAI_API_KEY=your_openai_api_key_here

# DeepSeek API
DEEPSEEK_API_KEY=your_deepseek_api_key_here

# Groq API
GROQ_API_KEY=your_groq_api_key_here

# Anthropic (Claude) API
ANTHROPIC_API_KEY=your_anthropic_api_key_here

# OpenRouter API
OPENROUTER_API_KEY=your_openrouter_api_key_here
```

**Примечание:** Файл `.env.local` не попадает в git (добавлен в .gitignore) для безопасности.

## Запуск приложения

```powershell
python main.py
```

При первом запуске автоматически создастся база данных `chatlist.db` с необходимыми таблицами.

## Использование

### Основной рабочий процесс

1. **Ввод промта:**
   - Введите новый промт в текстовое поле, или
   - Выберите сохраненный промт из выпадающего списка

2. **Выбор моделей:**
   - Отметьте чекбоксы моделей, к которым хотите отправить запрос
   - Используйте кнопки "Выбрать все" / "Снять все" для быстрого выбора

3. **Отправка запросов:**
   - Нажмите кнопку "Отправить"
   - Дождитесь получения всех ответов (прогресс отображается в прогресс-баре)

4. **Сохранение результатов:**
   - Отметьте чекбоксы интересных результатов
   - Нажмите "Сохранить выбранные" для записи в базу данных

### Управление моделями

Меню: **Файл -> Управление моделями**

- Добавление новых моделей с настройками API
- Редактирование существующих моделей
- Активация/деактивация моделей
- Удаление моделей

**Параметры модели:**
- Название — отображаемое имя модели
- API URL — endpoint для запросов
- Ключ (env) — имя переменной окружения с API-ключом
- Тип модели — тип провайдера (openai, deepseek, groq, anthropic, openrouter)

### Управление промтами

Меню: **Файл -> Управление промтами**

- Просмотр всех сохраненных промтов
- Поиск по тексту промта или тегам
- Сортировка по колонкам
- Удаление промтов

### Просмотр результатов

Меню: **Файл -> Сохраненные результаты**

- Просмотр всех сохраненных результатов
- Поиск по промту, модели или ответу
- Сортировка по колонкам
- Экспорт в Markdown или JSON
- Удаление результатов

### Экспорт данных

В окне "Сохраненные результаты" доступны кнопки:
- **Экспорт Markdown** — сохраняет результаты в формате Markdown
- **Экспорт JSON** — сохраняет результаты в формате JSON

## Структура проекта

```
ChatList/
├── main.py          # Основной GUI интерфейс
├── db.py            # Работа с базой данных SQLite
├── models.py        # Логика работы с моделями
├── network.py       # Отправка HTTP-запросов к API
├── config.py        # Конфигурация и переменные окружения
├── logger.py        # Логирование запросов
├── requirements.txt # Зависимости проекта
├── build.ps1        # Скрипт сборки исполняемого файла
├── .env.local       # API-ключи (создается вручную)
├── chatlist.db      # База данных (создается автоматически)
└── logs/            # Логи приложения
```

## База данных

Приложение использует SQLite для хранения данных. База данных создается автоматически при первом запуске.

**Таблицы:**
- `prompts` — сохраненные промты
- `models` — настройки моделей нейросетей
- `results` — сохраненные результаты запросов
- `settings` — настройки приложения

Подробное описание схемы БД см. в файле `DATABASE.md`.

## Логирование

Все запросы к API логируются в файл `logs/chatlist.log`:
- Успешные запросы с информацией о токенах и времени выполнения
- Ошибки с описанием проблемы

## Создание исполняемого файла

Для создания исполняемого `.exe` файла используйте скрипт сборки:

```powershell
.\build.ps1
```

Или выполните команду вручную:

```powershell
pip install -r requirements.txt
python -m PyInstaller --onefile --windowed --name="ChatList" main.py
```

После выполнения команды исполняемый файл `ChatList.exe` будет находиться в папке `dist\`.

### Параметры PyInstaller:
- `--onefile` - создает один исполняемый файл (вместо папки с множеством файлов)
- `--windowed` - скрывает консольное окно (для GUI приложений)
- `--name="ChatList"` - имя выходного файла

## Создание инсталлятора

Для создания инсталлятора с помощью Inno Setup используйте скрипт:

```powershell
.\build-installer.ps1
```

**Требования:**
- Inno Setup 6 должен быть установлен
- Исполняемый файл должен быть создан (выполните `.\build.ps1` сначала)

### Установка Inno Setup

1. Скачайте Inno Setup с официального сайта: https://jrsoftware.org/isdl.php
2. Установите Inno Setup (рекомендуется версия 6)
3. Скрипт автоматически найдет Inno Setup в стандартных местах

**Альтернативные варианты:**

Если Inno Setup установлен в нестандартное место, укажите путь через переменную окружения:

```powershell
$env:INNO_SETUP_PATH = "C:\Путь\К\Inno Setup 6\ISCC.exe"
.\build-installer.ps1
```

Или добавьте Inno Setup в PATH системы.

**Что делает инсталлятор:**
- Устанавливает программу в папку `Program Files\ChatList`
- Создает ярлыки в меню "Пуск" и на рабочем столе (опционально)
- Добавляет запись в "Программы и компоненты" для удаления
- Включает секцию Uninstall для полного удаления программы

**Результат:**
Инсталлятор `ChatList-Setup-v1.0.0.exe` будет создан в папке `installer\`.

## Дополнительные функции

- ✅ Поиск и сортировка во всех таблицах
- ✅ Экспорт результатов в Markdown и JSON
- ✅ Логирование всех запросов к API
- ✅ Поддержка нескольких типов API провайдеров
- ✅ Асинхронная отправка запросов
- ✅ Визуальная индикация ошибок

## Требования к системе

- Windows 10/11 (или Linux/macOS с PyQt5)
- Python 3.11 или выше
- Интернет-соединение для работы с API

## Лицензия

См. файл LICENSE

## Поддержка

При возникновении проблем:
1. Проверьте наличие API-ключей в файле `.env.local`
2. Убедитесь, что все зависимости установлены
3. Проверьте логи в папке `logs/`
4. Убедитесь, что модели правильно настроены в меню "Управление моделями"
